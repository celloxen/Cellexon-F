document.getElementById('patientForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const patientData = {
        first_name: document.getElementById('firstName').value,
        last_name: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        date_of_birth: document.getElementById('dateOfBirth').value,
        patient_id: 'CEL' + Date.now(),
        clinic_id: 1  // Default to first clinic
    };
    
    const { data, error } = await supabase
        .from('patients')
        .insert([patientData]);
        
    if (error) {
        alert('Error: ' + error.message);
    } else {
        alert('Patient registered successfully!');
        document.getElementById('patientForm').reset();
        loadPatients();
    }
});
